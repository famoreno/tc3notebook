<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>Nivel 3: Estructurado</title>
	<link rel="stylesheet" href="style.css">
</head>
<body>
	<article id="203dc82f-49f8-80b6-859e-e3a86f879d8c" class="page sans">
		<header><img class="page-cover-image" src="https://www.notion.so/images/page-cover/solid_yellow.png"
				style="object-position:center 40%" />
			<div class="page-header-icon page-header-icon-with-cover"><img class="icon"
					src="https://www.notion.so/icons/subtask_gray.svg" /></div>
			<h1 class="page-title">Nivel 3: Estructurado</h1>
			<p class="page-description"></p>
		</header>
		<div class="page-body">
			<details open="">
				<summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">Introducción y Objetivos
				</summary>
				<div class="indented">
					<ul id="203dc82f-49f8-80a4-a737-c9f48042ac16" class="block-color-teal_background toggle">
						<li>
							<details open="">
								<summary><strong>Introducción</strong></summary>
								<ul id="203dc82f-49f8-801c-b29b-ead2abba3638" class="bulleted-list">
									<li style="list-style-type:disc">Esta sección describe un enfoque modular para
										estructurar proyectos de automatización en TwinCAT 3, utilizando <em>Function
											Blocks</em> (FBs) basados en <em>Sequential Function Chart</em> (SFC). </li>
								</ul>
								<ul id="203dc82f-49f8-80f9-a66e-dc54429ca418" class="bulleted-list">
									<li style="list-style-type:disc">Tomaremos como ejemplo el control de una estación
										SMC FMS203, pasando de una implementación monolítica (toda la lógica de control
										en un único FB) a una estructura modular.</li>
								</ul>
								<ul id="203dc82f-49f8-80bf-adf4-e2c6c71430b9" class="bulleted-list">
									<li style="list-style-type:disc">En proyectos iniciales o más simples, es común
										implementar toda la lógica de control dentro de un único POU (<em>Program
											Organization Unit</em>), a menudo un solo <em>Function Block</em> grande.
									</li>
								</ul>
								<ul id="203dc82f-49f8-8040-930e-ddc3fddd77ed" class="toggle">
									<li>
										<details open="">
											<summary>Si bien esto puede parecer directo al principio, presenta
												desventajas a medida que el proyecto crece:</summary>
											<ul id="203dc82f-49f8-804a-adc0-ce81a7596fc3" class="bulleted-list">
												<li style="list-style-type:disc"><strong>Baja Legibilidad:</strong> Un
													FB grande con muchas responsabilidades se vuelve difícil de entender
													y seguir.</li>
											</ul>
											<ul id="203dc82f-49f8-8067-b50b-c268c7366bf1" class="bulleted-list">
												<li style="list-style-type:disc"><strong>Difícil
														Mantenimiento:</strong> Modificar una parte puede afectar
													inesperadamente a otras. La depuración es compleja.</li>
											</ul>
											<ul id="203dc82f-49f8-802c-977b-eaefd5ef18a8" class="bulleted-list">
												<li style="list-style-type:disc"><strong>Poca Reutilización:</strong> Es
													complicado extraer partes específicas para usarlas en otros
													proyectos o estaciones.</li>
											</ul>
											<ul id="203dc82f-49f8-807f-89d0-eb8524320fda" class="bulleted-list">
												<li style="list-style-type:disc"><strong>Complejidad en
														Pruebas:</strong> Probar funcionalidades específicas de forma
													aislada es casi imposible.</li>
											</ul>
										</details>
									</li>
								</ul>
								<ul id="203dc82f-49f8-8009-9cbf-e4220dece6ec" class="bulleted-list">
									<li style="list-style-type:disc">La <strong>estructuración modular</strong>, como la
										implementada en los FBs proporcionados, aborda estos problemas dividiendo la
										funcionalidad en bloques más pequeños y manejables, cada uno con una
										responsabilidad clara.</li>
								</ul>
								<ul id="203dc82f-49f8-8085-bccd-fd13f53249c3" class="toggle">
									<li>
										<details open="">
											<summary><strong>Beneficios del Enfoque Modular:</strong></summary>
											<ul id="203dc82f-49f8-8060-babd-e4321c982e34" class="bulleted-list">
												<li style="list-style-type:disc"><strong>Claridad:</strong> Cada FB
													realiza una tarea específica (ej. Cargar Base, Prensar Rodamiento).
												</li>
											</ul>
											<ul id="203dc82f-49f8-8048-b2c4-cdadb17ae1c7" class="bulleted-list">
												<li style="list-style-type:disc"><strong>Reutilización:</strong> Los FBs
													de tareas pueden ser reutilizados en otras estaciones o proyectos
													con lógica similar.</li>
											</ul>
											<ul id="203dc82f-49f8-807b-ad5d-de07e266ddf0" class="bulleted-list">
												<li style="list-style-type:disc"><strong>Mantenimiento:</strong> Los
													cambios se localizan en FBs específicos, reduciendo el riesgo de
													efectos secundarios.</li>
											</ul>
											<ul id="203dc82f-49f8-8092-b0cc-caec14677f87" class="bulleted-list">
												<li style="list-style-type:disc"><strong>Testabilidad:</strong> Cada FB
													puede probarse individualmente (si se diseña adecuadamente).</li>
											</ul>
											<ul id="203dc82f-49f8-80ff-bcbb-c992b8c0713f" class="bulleted-list">
												<li style="list-style-type:disc">
													<strong>Colaboración:</strong> Diferentes desarrolladores pueden
													trabajar en distintos FBs simultáneamente.</li>
											</ul>
										</details>
									</li>
								</ul>
							</details>
						</li>
					</ul>
					<ul id="203dc82f-49f8-80e1-abfb-e4ed919e45ff" class="block-color-teal_background toggle">
						<li>
							<details open="">
								<summary><strong>Objetivos</strong></summary>
								<ul id="203dc82f-49f8-80a1-bc43-e694c62b1982" class="bulleted-list">
									<li style="list-style-type:disc">Implementar la secuencia completa de funcionamiento
										de la estación (producción normal) distribuida en varios componentes (tareas).
									</li>
								</ul>
								<ul id="203dc82f-49f8-8013-af86-e731fe297929" class="bulleted-list">
									<li style="list-style-type:disc">Estructurar el código en distintos FBs, uno para
										cada tarea, donde se implementa un comportamiento (funcionalidad) con sentido en
										sí mismo y reutilizable (ej. situar palé).</li>
								</ul>
								<ul id="203dc82f-49f8-8062-ae2c-cb1f4bd80700" class="bulleted-list">
									<li style="list-style-type:disc">Para coordinar el funcionamiento de cada una de las
										<strong>Tareas </strong>se dispondrá de un <strong>Coordinador</strong> que
										indicará en cada momento qué <strong>Tareas </strong>deben realizarse.</li>
								</ul>
								<ul id="203dc82f-49f8-80e6-91d4-d476a8c8bf66" class="bulleted-list">
									<li style="list-style-type:disc">El acceso al <em>hardware </em>se realiza en el FB
										de la <strong>Estación</strong>, que debe coordinar el uso compartido del mismo
										por parte de los distintos FBs.</li>
								</ul>
								<ul id="203dc82f-49f8-8067-9fa8-d0bb3d092cc1" class="bulleted-list">
									<li style="list-style-type:disc">Las <strong>Tareas </strong>(rutinas) y el
										<strong>Coordinador </strong>disponen de parámetros de entrada y salida para
										comunicarse entre sí.</li>
								</ul>
							</details>
						</li>
					</ul>
					<ul id="203dc82f-49f8-806e-9506-edf94760d6f4" class="block-color-default_background toggle">
						<li>
							<details open="">
								<summary><strong>Requisitos</strong></summary>
								<ul id="203dc82f-49f8-8072-a194-e989d6a4d41e" class="bulleted-list">
									<li style="list-style-type:disc">El <strong>programa </strong>debe mantener todas
										las funcionalidades del nivel anterior (<code>Monolítico</code>)</li>
								</ul>
								<ul id="203dc82f-49f8-807c-a61b-fd625e9a2bfe" class="toggle">
									<li>
										<details open="">
											<summary>El <strong>programa </strong>debe incluir:</summary>
											<ul id="203dc82f-49f8-8083-9f7c-e5bfef06ac18" class="bulleted-list">
												<li style="list-style-type:disc">Un pograma <code>MAIN</code> en
													<code>ST</code></li>
											</ul>
											<ul id="203dc82f-49f8-8038-a537-d7bef8b7295f" class="bulleted-list">
												<li style="list-style-type:disc">Un FB <strong>Estación</strong> en
													<code>ST</code> </li>
											</ul>
											<ul id="203dc82f-49f8-80f9-8bb9-e6f219e3e517" class="bulleted-list">
												<li style="list-style-type:disc">Un FB <strong>Coordinador</strong> en
													<code>SFC</code> que se encarga de coordinar el funcionamiento de
													las <strong>Tareas</strong></li>
											</ul>
											<ul id="203dc82f-49f8-8078-a52f-e041d26815d5" class="bulleted-list">
												<li style="list-style-type:disc">Un conjunto de FBs para las
													<strong>Tareas </strong>implementados en <code>SFC</code></li>
											</ul>
											<ul id="203dc82f-49f8-80e9-bc8e-fdfe5adc33d2" class="bulleted-list">
												<li style="list-style-type:disc">Una <strong>Visualización</strong></li>
											</ul>
										</details>
									</li>
								</ul>
								<ul id="203dc82f-49f8-8025-9cf4-c1bf1e77b8af" class="bulleted-list">
									<li style="list-style-type:disc">El <strong>programa </strong>debe permitir conmutar
										entre modo <strong>manual </strong>(se puede actuar sobre la estación desde la
										visualización) y modo <strong>automático </strong>(el programa produce) mediante
										el conmutador del <strong>Panel del Operador</strong> en el frente de la
										estación.</li>
								</ul>
								<ul id="241dc82f-49f8-8014-a282-c797701a122c" class="toggle">
									<li>
										<details open="">
											<summary>El <strong>programa </strong>debe considerar las
												<strong>Condiciones Iniciales</strong> (CI) y la <strong>Condición de
													Marcha</strong> (CM) antes de permitir que la estación comience a
												producir.</summary>
											<ul id="241dc82f-49f8-80ee-9823-cfa3f1411048" class="bulleted-list">
												<li style="list-style-type:disc">Las <strong>CI</strong> engloba a todas
													aquellas señales que deberían estar activas (o inactivas) en la
													estación para considerar que cumple con todos los requisitos de
													seguridad y operatividad necesarios para empezar a producir.
													<strong>Son de especial relevancia aquellas señales que determinan
														la posición de los actuadores biestables</strong>.
													<script
														src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
														integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
														crossorigin="anonymous" referrerPolicy="no-referrer"></script>
													<link rel="stylesheet"
														href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
														integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
														crossorigin="anonymous" referrerPolicy="no-referrer" />
													<pre id="241dc82f-49f8-80cb-915c-fadc5d32f4e1"
														class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">CondicionesIniciales := ManipuladorArriba AND EstacionConectada;</code></pre>
												</li>
											</ul>
											<ul id="241dc82f-49f8-80d6-897e-c848c07daed9" class="bulleted-list">
												<li style="list-style-type:disc">La <strong>CM</strong> indica aquellas
													condiciones que debe cumplirse para que la estación comience a
													producir (una vez satisfechas las <strong>CI</strong>).
													<script
														src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
														integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
														crossorigin="anonymous" referrerPolicy="no-referrer"></script>
													<link rel="stylesheet"
														href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
														integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
														crossorigin="anonymous" referrerPolicy="no-referrer" />
													<pre id="241dc82f-49f8-809e-b12d-c3ce2f40b10e"
														class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">CondicionMarcha := (UnidadesSolicitadas&gt;0);</code></pre>
												</li>
											</ul>
											<ul id="241dc82f-49f8-8083-b86b-db28b73fb424"
												class="block-color-red_background bulleted-list">
												<li style="list-style-type:disc">Cada grupo deberá identificar las
													<strong>CI</strong> y la <strong>CM</strong> particular para su
													estación.</li>
											</ul>
										</details>
									</li>
								</ul>
								<ul id="203dc82f-49f8-80d2-b355-e4bf8bb22eff" class="toggle">
									<li>
										<details open="">
											<summary>La <strong>visualización</strong> debe mostrar el valor de las
												siguientes variables de la tarea:</summary>
											<figure id="203dc82f-49f8-80f0-883b-c010cb1f8166" class="image"
												style="text-align:center"><a href="images/n3/image.png"><img style="width:192px"
														src="images/n3/image.png" /></a>
												<figcaption>Panel de la tarea</figcaption>
											</figure>
											<ul id="203dc82f-49f8-8015-adc3-e35aae07aba3" class="bulleted-list">
												<li style="list-style-type:disc"><code>UnidadesSolicitadas</code>:
													Variable que contiene el número de piezas que se quieren producir en
													un lote. <strong>Debe poder ser editada desde la
														visualización</strong>.<strong> </strong>El programa debe ser
													capaz de, tras pulsar el <strong>Pulsador de Marcha</strong>,
													producir el número de piezas especificado en esta variable. Esto se
													denomina <strong>Producción por Lotes</strong>.</li>
											</ul>
											<ul id="203dc82f-49f8-8026-895d-fee38a1d744e" class="bulleted-list">
												<li style="list-style-type:disc"><code>UnidadesPendientes</code>:
													Contador que toma inicialmente el valor de
													<code>UnidadesSolicitadas </code>y se decrementa cada vez que se
													produce una pieza. Se reinicia cada vez que se acaba el lote.</li>
											</ul>
											<ul id="203dc82f-49f8-803f-a9a8-f89ab7dfda02" class="bulleted-list">
												<li style="list-style-type:disc"><code>UnidadesRealizadas</code>:
													Contador que empieza en cero y se incrementa cada vez que se produce
													una pieza. No se reincia cada vez que acaba el lote.</li>
											</ul>
											<ul id="203dc82f-49f8-8001-b0c6-cd9c55c53ef6" class="bulleted-list">
												<li style="list-style-type:disc"><code>UnidadesRechazadas</code>: (si
													aplica). Contador que empieza en cero y se incrementa cada vez que
													se rechaza una pieza. No se reinicia cada vez que acaba el lote.
												</li>
											</ul>
											<ul id="203dc82f-49f8-805f-b41f-db38efd849e3" class="bulleted-list">
												<li style="list-style-type:disc">Selección de las piezas a producir
													(ejemplo: rodamiento alto o bajo).</li>
											</ul>
										</details>
									</li>
								</ul>
								<ul id="203dc82f-49f8-80f7-87d1-d03824cec6e4" class="toggle">
									<li>
										<details open="">
											<summary>La <strong>visualización </strong>debe incluir, en su parte
												inferior, una serie de indicadores y botones que permiten conocer el
												estado de las condiciones de la estación y modificar su comportamiento:
											</summary>
											<figure id="203dc82f-49f8-8000-b9e8-d35c59508529" class="image"
												style="text-align:center"><a href="images/n3/image 1.png"><img
														style="width:288px" src="images/n3/image 1.png" /></a></figure>
											<ul id="203dc82f-49f8-806f-9f66-ece494c5dc2b" class="bulleted-list">
												<li style="list-style-type:disc"><code>CI</code>: Indicador que muestra
													si se cumplen o no las condiciones iniciales.</li>
											</ul>
											<ul id="203dc82f-49f8-80aa-b82b-f55c6f6f52f5" class="bulleted-list">
												<li style="list-style-type:disc"><code>CM</code>: Indicador que muestra
													si se cumple o no la condición de marcha.</li>
											</ul>
											<ul id="203dc82f-49f8-80fc-9b0d-c4c1de8bd53d" class="bulleted-list">
												<li style="list-style-type:disc"><code>Ciclo</code> [<mark
														class="highlight-blue">toggle</mark>]: Botón que indica que la
													estación debe operar <strong>Ciclo a Ciclo</strong>, esto es, debe
													parar entre cada iteración del lote hasta que se pulse el
													<strong>Pulsador de Marcha</strong>. Debe seguir produciendo el
													número de piezas que se especificó para el lote.</li>
											</ul>
											<ul id="203dc82f-49f8-801a-963e-e24dca51ad98" class="bulleted-list">
												<li style="list-style-type:disc"><code>Pause</code> [<mark
														class="highlight-blue">toggle</mark>]: Botón que pausa la
													estación en su estado actual. Relacionado con SFCPause.</li>
											</ul>
											<ul id="203dc82f-49f8-808a-9bdf-eafbe71548c1" class="bulleted-list">
												<li style="list-style-type:disc"><code>Reset</code> [<mark
														class="highlight-teal">tap</mark>]: Botón que reinicia la
													estación y la devuelve a su estado inicial. Relacionado con
													SFCReset. </li>
											</ul>
										</details>
									</li>
								</ul>
								<ul id="203dc82f-49f8-809d-96a4-d1195736a7c7" class="toggle">
									<li>
										<details open="">
											<summary>La <strong>visualización </strong>debe permitir, en la sección
												<code>PARÁMETROS</code>, introducir los valores de los <strong>tiempos
												</strong>utilizados en todos los FBs del programa, con el formato de las
												variables de tipo <code>TIME</code></summary>
											<figure id="203dc82f-49f8-80d6-8f5b-f8c3d3ccbe8f" class="image"
												style="text-align:center"><a href="images/n3/image 2.png"><img
														style="width:144px" src="images/n3/image 2.png" /></a></figure>
										</details>
									</li>
								</ul>
							</details>
						</li>
					</ul>
					<ul id="203dc82f-49f8-8015-9bee-d5ca7c8477ed" class="block-color-purple_background bulleted-list">
						<li style="list-style-type:disc"><strong>Duración estimada: 6 - 8 sesiones</strong></li>
					</ul>
				</div>
			</details>
			<details open="">
				<summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">Jerarquía del Proyecto
					Estructurado</summary>
				<div class="indented">
					<ol type="1" id="203dc82f-49f8-80bc-ba27-e26e8007f160" class="numbered-list" start="1">
						<li><code><strong>MAIN</strong></code><strong> (Programa Principal):</strong> <ul
								id="203dc82f-49f8-8043-a69e-e305325ae237" class="bulleted-list">
								<li style="list-style-type:disc">Es el punto de entrada. </li>
							</ul>
							<ul id="203dc82f-49f8-80a5-8bc0-de09bd6b01c9" class="bulleted-list">
								<li style="list-style-type:disc">Su única responsabilidad es declarar una variable de
									tipo <code>FB_Estacion</code> e instanciarla. </li>
							</ul>
						</li>
					</ol>
					<ol type="1" id="203dc82f-49f8-8014-bbed-cc7d0a0928e9" class="numbered-list" start="2">
						<li><code><strong>FB_Estacion</strong></code><strong> (FB principal):</strong> <ul
								id="203dc82f-49f8-80d5-89dc-f4b3d5345a93" class="bulleted-list">
								<li style="list-style-type:disc">Actúa como el centro neurálgico de la estación.</li>
							</ul>
							<ul id="203dc82f-49f8-80d9-8376-f1dcbe479094" class="bulleted-list">
								<li style="list-style-type:disc">Declara <strong>todas</strong> las variables de
									Entrada/Salida (E/S) físicas (<code>AT %I*</code>, <code>AT %Q*</code>).</li>
							</ul>
							<ul id="203dc82f-49f8-802d-b72c-d3b374d146c1"
								class="block-color-yellow_background bulleted-list">
								<li style="list-style-type:disc"><mark class="highlight-red"><mark
											class="highlight-yellow_background"><strong>[NUEVO]
											</strong></mark></mark>Declara e instancia todos los FBs necesarios: <ul
										id="241dc82f-49f8-80f5-ab1d-c063f3557b48" class="bulleted-list">
										<li style="list-style-type:circle"><code>FB_Coordinador_SFC</code></li>
									</ul>
									<ul id="241dc82f-49f8-8026-9251-fd7f013be771" class="bulleted-list">
										<li style="list-style-type:circle">Todos los FBs de tareas:
											<code>FB_SituarPale_SFC</code>, <code>FB_CargarBase_SFC</code>, etc.</li>
									</ul>
								</li>
							</ul>
							<ul id="203dc82f-49f8-8025-ab31-f7f5a8a26441"
								class="block-color-yellow_background bulleted-list">
								<li style="list-style-type:disc"><mark class="highlight-red"><mark
											class="highlight-yellow_background"><strong>[NUEVO]
											</strong></mark></mark>Conecta las E/S físicas a las variables de interfaz
									(entradas y salidas) de los FBs de tareas.</li>
							</ul>
							<ul id="203dc82f-49f8-8068-8dc7-e2fc55e6ce7f"
								class="block-color-yellow_background bulleted-list">
								<li style="list-style-type:disc"><mark class="highlight-red"><mark
											class="highlight-yellow_background"><strong>[NUEVO]
											</strong></mark></mark>Gestiona el paso de señales de control y
									sincronización entre el coordinador y los FBs de tareas.</li>
							</ul>
							<ul id="203dc82f-49f8-8022-8c9e-c08073ad9f6d" class="bulleted-list">
								<li style="list-style-type:disc">Define parámetros globales de la estación (tiempos,
									modos, etc.).</li>
							</ul>
						</li>
					</ol>
					<ol type="1" id="203dc82f-49f8-80d0-9e20-d25160600d84"
						class="block-color-yellow_background numbered-list" start="3">
						<li><mark class="highlight-red"><mark class="highlight-yellow_background"><strong>[NUEVO]
									</strong></mark></mark><code><strong>FB_Coordinador_SFC</strong></code><strong> (FB
								Coordinador):</strong> <ul id="203dc82f-49f8-8089-b828-f3b23f7c14a5"
								class="bulleted-list">
								<li style="list-style-type:disc">Orquesta la secuencia general de operación.</li>
							</ul>
							<ul id="203dc82f-49f8-808a-a447-f74f92348af1" class="bulleted-list">
								<li style="list-style-type:disc">Define el flujo principal del proceso mediante un
									<code>SFC</code>.</li>
							</ul>
							<ul id="203dc82f-49f8-8095-a85b-ebfa0eb2b821" class="bulleted-list">
								<li style="list-style-type:disc">Activa los FBs de tareas en el orden correcto usando
									sus señales <code>Execute</code>.</li>
							</ul>
							<ul id="203dc82f-49f8-80b9-85fb-cfc81634f6ff" class="bulleted-list">
								<li style="list-style-type:disc">Espera la finalización de cada tarea monitorizando sus
									señales <code>Done</code>.</li>
							</ul>
							<ul id="203dc82f-49f8-809d-a191-c9d6bd3a1bfe" class="bulleted-list">
								<li style="list-style-type:disc">Gestiona la lógica de producción (ej. contar unidades,
									bucles).</li>
							</ul>
						</li>
					</ol>
					<ol type="1" id="203dc82f-49f8-808c-9cc7-f91e4a9c7a6a"
						class="block-color-yellow_background numbered-list" start="4">
						<li><mark class="highlight-red"><mark class="highlight-yellow_background"><strong>[NUEVO]
									</strong></mark></mark><code><strong>FB*_xxx_SFC</strong></code><strong> (FBs de
								Tareas)
								(ej. </strong><code><strong>FB_CargarBase_SFC</strong></code><strong>):</strong> <ul
								id="203dc82f-49f8-80b1-98ad-e052c0f7ef77"
								class="block-color-red_background bulleted-list">
								<li style="list-style-type:disc">Cada grupo deberá decidir cómo divide el funcionamiento
									de su estación en un conjunto adecuado de <strong>Tareas </strong>y creará un
									conjunto de FBs que las implemente.</li>
							</ul>
							<ul id="203dc82f-49f8-805c-b0df-fd55853c4440" class="bulleted-list">
								<li style="list-style-type:disc">Implementan la lógica secuencial detallada para una
									operación <strong>específica</strong>.</li>
							</ul>
							<ul id="203dc82f-49f8-80f6-8139-d2ecebe70bd1" class="bulleted-list">
								<li style="list-style-type:disc">Contienen un <code>SFC</code> que describe los pasos
									para completar su tarea.</li>
							</ul>
							<ul id="203dc82f-49f8-8095-a186-e7dfc41c6d76" class="bulleted-list">
								<li style="list-style-type:disc">Reciben una señal <code>Execute</code> para iniciar su
									secuencia.</li>
							</ul>
							<ul id="203dc82f-49f8-800a-816f-de71d3316d5a" class="bulleted-list">
								<li style="list-style-type:disc">Señalan su finalización con una
									señal <code>Done</code>.</li>
							</ul>
							<ul id="203dc82f-49f8-80c8-8332-e400d22e7d6a" class="bulleted-list">
								<li style="list-style-type:disc">Utilizan un patrón de
									<em>handshake</em> <code>Ready/Execute</code> y <code>Done/Ack</code> para
									sincronizarse con el coordinador.</li>
							</ul>
							<ul id="203dc82f-49f8-8070-8d07-d9e27143d104" class="bulleted-list">
								<li style="list-style-type:disc">Leen sensores y activan actuadores necesarios para su
									tarea (a través de variables conectadas en <code>FB_Estacion</code>).</li>
							</ul>
						</li>
					</ol>
					<ol type="1" id="245dc82f-49f8-80c8-8f91-e9438e533d8c" class="numbered-list" start="5">
						<li><code>FB_Clock</code>: <strong>Generador de onda cuadrada</strong>.<ul
								id="245dc82f-49f8-803d-875a-e4239724e9ea" class="bulleted-list">
								<li style="list-style-type:disc">Se utiliza para conseguir una señal binaria que alterna
									su valor a lo largo del tiempo, a una frecuencia determinada.</li>
							</ul>
							<ul id="245dc82f-49f8-8051-896d-c786102e8057" class="bulleted-list">
								<li style="list-style-type:disc">Podemos utilizar su salida para conseguir que una
									lámpara parpadee o que un avisador suene intermitentemente.
									<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
										integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
										crossorigin="anonymous" referrerPolicy="no-referrer"></script>
									<link rel="stylesheet"
										href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
										integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
										crossorigin="anonymous" referrerPolicy="no-referrer" />
									<pre id="245dc82f-49f8-80dd-9ee6-ee6d464c962d" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">CLK: FB_Clock;
-------------------------------------------------------
LamparaMarcha := CondicionInicial AND CLK.Q;
CLK();</code></pre>
								</li>
							</ul>
						</li>
					</ol>
				</div>
			</details>
			<details open="">
				<summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">Estructura estándar de un FB
					de Tarea en SFC</summary>
				<div class="indented">
					<ul id="203dc82f-49f8-800f-8f9d-f372293bc6df" class="block-color-default bulleted-list">
						<li style="list-style-type:disc">Tanto el FB <strong>Coordinador </strong>como los FBs de tareas
							(<code>FB_CargarBase_SFC</code>,  <code>FB_SituarPale_SFC</code>, etc.) siguen una
							estructura <code>SFC</code> común diseñada para la sincronización:<figure
								id="203dc82f-49f8-80ee-bd4a-fb7874a94d9c" class="image" style="text-align:center"><a
									href="images/n3/image 3.png"><img style="width:240px" src="images/n3/image 3.png" /></a>
								<figcaption>Estructura genérica de un FB</figcaption>
							</figure>
						</li>
					</ul>
					<ul id="203dc82f-49f8-8025-ac03-dadcd9067d25" class="bulleted-list">
						<li style="list-style-type:disc"><strong>Etapa
							</strong><code><strong>Initial</strong></code><strong>:</strong>
							<ul id="203dc82f-49f8-8015-914a-fd7bbe385b76" class="bulleted-list">
								<li style="list-style-type:circle">Es el estado de reposo del FB.</li>
							</ul>
							<ul id="203dc82f-49f8-80ad-9ffd-e5b4406e9b4b" class="bulleted-list">
								<li style="list-style-type:circle">Se activa la salida <code>Ready</code>, que indica
									que el FB está listo para recibir una orden.</li>
							</ul>
							<ul id="203dc82f-49f8-804b-bbc7-fa51a99425cd" class="bulleted-list">
								<li style="list-style-type:circle">La primera transición espera la señal de
									entrada <code>Execute</code>, que será activada por otro bloque funcional.</li>
							</ul>
						</li>
					</ul>
					<ul id="203dc82f-49f8-805a-b40c-dbc294843c7c" class="bulleted-list">
						<li style="list-style-type:disc"><strong>Etapas Intermedias
								(</strong><code><strong>S1</strong></code><strong>, </strong><code><strong>S2</strong></code><strong>,
								...):</strong>
							<ul id="203dc82f-49f8-805a-b83a-c6bd66901231" class="bulleted-list">
								<li style="list-style-type:circle">Implementan la <strong>lógica de control</strong>
									secuencial del FB.</li>
							</ul>
							<ul id="203dc82f-49f8-80e5-932f-e2f2aee0e22b" class="bulleted-list">
								<li style="list-style-type:circle">Activan/desactivan las salidas necesarias
									(actuadores) mediante acciones memorizadas o no memorizadas.</li>
							</ul>
							<ul id="203dc82f-49f8-80b3-bfc7-e5d5b35184c3" class="bulleted-list">
								<li style="list-style-type:circle">Las transiciones entre pasos esperan condiciones de
									proceso (sensores, temporizadores, o señales de sincronización como las señales
									<code>Done</code> de otros FBs en el caso del <code>FB_Coordinador_SFC</code>).</li>
							</ul>
						</li>
					</ul>
					<ul id="203dc82f-49f8-803e-891d-fece7700f408" class="bulleted-list">
						<li style="list-style-type:disc"><strong>Etapa
							</strong><code><strong>End</strong></code><strong>:</strong>
							<ul id="203dc82f-49f8-804c-ab1f-cfb97e17d242" class="bulleted-list">
								<li style="list-style-type:circle">Es el estado final de la secuencia de la tarea.</li>
							</ul>
							<ul id="203dc82f-49f8-8030-971f-c92e7627efc5" class="bulleted-list">
								<li style="list-style-type:circle">Se activa la salida <code>Done</code> para indicar
									que la lógica de control del FB ha finalizado.</li>
							</ul>
							<ul id="203dc82f-49f8-804d-ae12-d7bb5dfc81e6" class="toggle">
								<li>
									<details open="">
										<summary>La última transición espera la señal de entrada <code>Ack</code> (acuse
											de recibo del FB que lo llama):</summary>
										<ul id="203dc82f-49f8-80b5-84d3-c3f737305991" class="bulleted-list">
											<li style="list-style-type:disc">Para los FBs de tareas, esta señal
												normalmente se gestiona en el nivel superior (<code>FB_Estacion</code>)
												poniéndola a <code>TRUE</code> cuando su correspondiente
												<code>Execute</code> es <code>FALSE</code>. Esto asegura que el FB de
												tarea vuelve a <code>Initial</code> sólo después de que el coordinador
												haya visto la señal <code>Done</code> y haya retirado la
												orden <code>Execute</code> (ha pasado a la siguiente etapa).</li>
										</ul>
										<ul id="203dc82f-49f8-80c6-8fbe-d6346c04563d" class="bulleted-list">
											<li style="list-style-type:disc">Para el <code>FB_Coordinador</code>, no hay
												nadie que le haya comandado funcionar, así que se le asigna el valor
												<code>TRUE</code> directamente para que vuelva a su etapa
												<code>Initial</code>.</li>
										</ul>
									</details>
								</li>
							</ul>
						</li>
					</ul>
				</div>
			</details>
			<details open="">
				<summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">Acceso a señales de
					<em>hardware</em></summary>
				<div class="indented">
					<ul id="203dc82f-49f8-8073-94c3-ce92cce029a7" class="bulleted-list">
						<li style="list-style-type:disc"><strong>IMPORTANTE</strong>: Nótese que todas las variables de
							acceso al <em>hardware </em>están declaradas en <code>FB_Estacion</code> <strong>y no en el
								resto de FBs</strong>. Con esto conseguimos compartir el acceso a determinados sensores
							o actuadores desde distintos bloques funcionales.</li>
					</ul>
					<ul id="203dc82f-49f8-8046-bde1-d0337233642b" class="bulleted-list">
						<li style="list-style-type:disc">Un punto clave es cómo un FB de un tarea
							(ej. <code>FB_CargarBase_SFC</code>) puede acceder al <em>hardware </em>de la estación si la
							declaración de las variables que tienen dicho acceso está situada
							en <code>FB_Estacion</code>. </li>
					</ul>
					<ul id="203dc82f-49f8-805f-a70b-fcf3fc05cc7b" class="toggle">
						<li>
							<details open="">
								<summary>Para las <strong>salidas </strong>(actuadores), </summary>
								<ul id="203dc82f-49f8-8026-9198-ce4862079d0e" class="bulleted-list">
									<li style="list-style-type:disc">La conexión entre las señales de la tarea y las que
										tienen acceso al <em>hardware </em>(ej. <code>ManipuladorSucciona AT %Q*</code>,
										declarada en <code>FB_Estacion</code>) se realiza en el
										propio <code>FB_Estacion</code>.</li>
								</ul>
								<ul id="203dc82f-49f8-8056-853d-d913105c1234" class="bulleted-list">
									<li style="list-style-type:disc"><strong>Declaración de variable de
											salida:</strong> <code>FB_Estacion</code> declara la variable que va a estar
										conectada a la salida física utilizando la especificación <code>AT %Q*</code>.
										También declara una <strong>instancia del FB de la tarea</strong>:
										<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
											integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
											crossorigin="anonymous" referrerPolicy="no-referrer"></script>
										<link rel="stylesheet"
											href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
											integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
											crossorigin="anonymous" referrerPolicy="no-referrer" />
										<pre id="203dc82f-49f8-8038-ac58-e86ca120568a" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">// En FB_Estacion
VAR
	ManipuladorSucciona AT %Q*: BOOL; // variable conectada a la salida
	CargarBase: FB_CargarBase_SFC; // FB de la tarea
END_VAR</code></pre>
									</li>
								</ul>
								<ul id="203dc82f-49f8-8062-87a7-d3f3a5235ae2" class="bulleted-list">
									<li style="list-style-type:disc"><strong>Declaración en la
											tarea:</strong> <code>FB_CargarBase_SFC</code> declara una salida lógica con
										el mismo propósito (nótese que esto es solo una variable <em>booleana</em>,
										<strong>sin </strong>acceso directo al <em>hardware </em>ya que no está
										declarada con <code>AT %Q*</code>):
										<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
											integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
											crossorigin="anonymous" referrerPolicy="no-referrer"></script>
										<link rel="stylesheet"
											href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
											integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
											crossorigin="anonymous" referrerPolicy="no-referrer" />
										<pre id="203dc82f-49f8-803e-baff-e9e2e7ff8d01" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">// En FB_CargarBase_SFC
VAR_OUTPUT
	ManipuladorSucciona: BOOL; // señal sin acceso directo a la salida
END_VAR</code></pre>
									</li>
								</ul>
								<ul id="203dc82f-49f8-803c-8f51-dad66249f82e" class="bulleted-list">
									<li style="list-style-type:disc"><strong>Conexión
											en </strong><code><strong>FB_Estacion</strong></code><strong>:</strong> En
										la implementación <code>ST</code> de <code>FB_Estacion</code>, se conectan
										ambas:
										<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
											integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
											crossorigin="anonymous" referrerPolicy="no-referrer"></script>
										<link rel="stylesheet"
											href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
											integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
											crossorigin="anonymous" referrerPolicy="no-referrer" />
										<pre id="203dc82f-49f8-80e3-894c-c085d1fa578a" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">// En la implementación ST de FB_Estacion
ManipuladorSucciona := CargarBase.ManipuladorSucciona;</code></pre>
									</li>
								</ul>
							</details>
						</li>
					</ul>
					<ul id="203dc82f-49f8-80b3-b235-e03b48a907bd" class="toggle">
						<li>
							<details open="">
								<summary>Para las <strong>entradas </strong>(sensores, pulsadores), el proceso es
									análogo:</summary>
								<ul id="203dc82f-49f8-808b-b7d9-f6f09fddf74d" class="bulleted-list">
									<li style="list-style-type:disc">Declaración física
										en <code>FB_Estacion</code> (<code>AT %I*</code>) e instancia del FB de la
										tarea.
										<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
											integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
											crossorigin="anonymous" referrerPolicy="no-referrer"></script>
										<link rel="stylesheet"
											href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
											integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
											crossorigin="anonymous" referrerPolicy="no-referrer" />
										<pre id="203dc82f-49f8-806a-a081-f9d99302a38a" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">// En FB_Estacion
VAR
	ManipuladorSucciona AT %Q*: BOOL; // del ejemplo anterior
	ManipuladorVacio AT %I*: BOOL; // variable conectada a la entrada
	CargarBase: FB_CargarBase_SFC; // FB de la tarea
END_VAR</code></pre>
									</li>
								</ul>
								<ul id="203dc82f-49f8-8083-9813-db774ad779e1" class="bulleted-list">
									<li style="list-style-type:disc">Declaración de interfaz en el FB de tarea
										(<code>VAR_INPUT</code>).
										<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
											integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
											crossorigin="anonymous" referrerPolicy="no-referrer"></script>
										<link rel="stylesheet"
											href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
											integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
											crossorigin="anonymous" referrerPolicy="no-referrer" />
										<pre id="203dc82f-49f8-8083-9813-db774ad779e1" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">// En FB_CargarBase_SFC
VAR_INPUT
	ManipuladorVacio: BOOL; // señal sin acceso directo a la entrada
END_VAR</code></pre>
									</li>
								</ul>
								<ul id="203dc82f-49f8-8075-a3c7-d08d41912e41" class="bulleted-list">
									<li style="list-style-type:disc">Conexión en <code>FB_Estacion</code> pasando la
										entrada física a la entrada del FB de la tarea en la llamada a la instancia de
										éste último:
										<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
											integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
											crossorigin="anonymous" referrerPolicy="no-referrer"></script>
										<link rel="stylesheet"
											href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
											integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
											crossorigin="anonymous" referrerPolicy="no-referrer" />
										<pre id="203dc82f-49f8-803e-874b-d5f7b965265e" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">// En la implementación ST de FB_Estacion
CargarBase(
    // ...
    ManipuladorVacio := ManipuladorVacio, // pasamos el valor del sensor
    // ...
);</code></pre>
									</li>
								</ul>
							</details>
						</li>
					</ul>
				</div>
			</details>
			<details open="">
				<summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">Gestión
					de <code>SFCReset</code> y <code>SFCPause</code></summary>
				<div class="indented">
					<ul id="203dc82f-49f8-8024-be62-ddf47077d756" class="bulleted-list">
						<li style="list-style-type:disc">Estas son <strong>entradas especiales </strong>proporcionadas
							por TwinCAT para FBs basados en <code>SFC</code> (se les denomina <code>SFC-Flags</code>).
							Permiten un control externo sobre la ejecución del código <code>SFC</code>.</li>
					</ul>
					<ul id="203dc82f-49f8-8060-a082-e2fda88d2bde" class="toggle">
						<li>
							<details open="">
								<summary>
									<code><strong>SFCPause</strong></code><strong> (</strong><code><strong>BOOL</strong></code><strong>):</strong>
								</summary>
								<ul id="203dc82f-49f8-808a-ac54-fb94bcfaa770" class="bulleted-list">
									<li style="list-style-type:disc">Si se pone a <code>TRUE</code>, el
										SFC <strong>congela</strong> su estado actual.</li>
								</ul>
								<ul id="203dc82f-49f8-80ac-8f96-f6841f0ced04" class="bulleted-list">
									<li style="list-style-type:disc">Los temporizadores de los pasos activos
										(<code>S1.t</code>,<code>S2.t</code>, etc.) dejan de contar.</li>
								</ul>
								<ul id="203dc82f-49f8-80cb-9e04-c0a62c833e9c" class="bulleted-list">
									<li style="list-style-type:disc">Las acciones
										activas <strong>continúan</strong> ejecutándose.</li>
								</ul>
								<ul id="203dc82f-49f8-8060-ac0a-e72b7b25903c" class="bulleted-list">
									<li style="list-style-type:disc">Las transiciones <strong>no</strong> se evalúan, es
										decir, el SFC no avanzará a pasos siguientes.</li>
								</ul>
								<ul id="203dc82f-49f8-800f-9197-db1fab87cd63" class="bulleted-list">
									<li style="list-style-type:disc">Cuando <code>SFCPause</code> vuelve
										a <code>FALSE</code>, el SFC reanuda la ejecución desde donde se quedó (los
										temporizadores continúan, las transiciones se evalúan).</li>
								</ul>
								<ul id="203dc82f-49f8-80e0-8495-d7f8dace4e3f" class="bulleted-list">
									<li style="list-style-type:disc">En el ejemplo de la estación
										203, <code>FB_Estacion</code> recibe una señal <code>PausaEstado</code> y la
										pasa a la entrada <code>SFCPause</code> de todos los FBs SFC relevantes
										(<code>Coordinador</code>, <code>SituarPale</code>, etc.), <strong>siempre que
											no esté activo </strong><code><strong>ReiniciaEstado</strong></code>.</li>
								</ul>
							</details>
						</li>
					</ul>
					<ul id="203dc82f-49f8-80a1-9f01-fdd73c974614" class="toggle">
						<li>
							<details open="">
								<summary>
									<code><strong>SFCReset</strong></code><strong> (</strong><code><strong>BOOL</strong></code><strong>):</strong>
								</summary>
								<ul id="203dc82f-49f8-8011-9ddf-ce90163cf49e" class="bulleted-list">
									<li style="list-style-type:disc">Si se pone a <code>TRUE</code>, el
										SFC <strong>fuerza</strong> el retorno al paso inicial (<code>Initial</code>).
									</li>
								</ul>
								<ul id="203dc82f-49f8-804f-9179-f3f51606218c" class="bulleted-list">
									<li style="list-style-type:disc">Todas las acciones se desactivan (como si se
										saliera de los pasos activos).</li>
								</ul>
								<ul id="203dc82f-49f8-8069-9fd7-e9339eaddf76" class="bulleted-list">
									<li style="list-style-type:disc">Las variables internas del SFC
										(como <code>S1.x</code> o <code>S1.t</code>) se reinician.</li>
								</ul>
								<ul id="203dc82f-49f8-8017-9593-f76479cd6f13" class="bulleted-list">
									<li style="list-style-type:disc">El SFC permanecerá en el
										paso <code>Initial</code> mientras <code>SFCReset</code> esté
										a <code>TRUE</code>.</li>
								</ul>
								<ul id="203dc82f-49f8-80d9-9498-cdf0820c7bc5" class="bulleted-list">
									<li style="list-style-type:disc">Normalmente, <code>SFCReset</code> se activa con un
										pulso (<em>tap</em>) o se mantiene activo durante la condición de reinicio.</li>
								</ul>
								<ul id="203dc82f-49f8-80d5-a456-f521f00318d9" class="bulleted-list">
									<li style="list-style-type:disc">En el ejemplo de la estación
										203, <code>FB_Estacion</code> recibe <code>ReiniciaEstado</code> y lo pasa a la
										entrada <code>SFCReset</code> de todos los FBs SFC.</li>
								</ul>
							</details>
						</li>
					</ul>
					<ul id="203dc82f-49f8-8011-b35a-da5ceec8c5d4" class="bulleted-list">
						<li style="list-style-type:disc">En nuestra implementación de ejemplo de la estación 203,
							<code>PausaEstado</code> y <code>ReiniciaEstado</code> están controlados por dos botones
							situados abajo a la derecha en la visualización.</li>
					</ul>
					<ul id="203dc82f-49f8-80ab-8725-d4c7cb9a1a1d" class="toggle">
						<li>
							<details open="">
								<summary><strong>Implementación Típica:</strong></summary>
								<ul id="203dc82f-49f8-8090-b5fa-f42a72a954f1" class="bulleted-list">
									<li style="list-style-type:disc">Como se ve en <code>FB_Estacion</code>, estas
										señales (<code>PausaEstado</code>, <code>ReiniciaEstado</code>) suelen venir de
										la lógica de control general de la máquina (HMI, pulsadores de control) y se
										distribuyen a todos los FBs <code>SFC</code> que necesiten ser pausados o
										reiniciados conjuntamente.</li>
								</ul>
								<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
									integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
									crossorigin="anonymous" referrerPolicy="no-referrer"></script>
								<link rel="stylesheet"
									href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
									integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
									crossorigin="anonymous" referrerPolicy="no-referrer" />
								<pre id="203dc82f-49f8-800e-bb24-cd666be2efad" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">// En la implementación ST de FB_Estacion (ejemplo simplificado)
Coordinador(
    SFCPause := NOT ReiniciaEstado AND PausaEstado,
    SFCReset := ReiniciaEstado,
    // ...
);
SituarPale(
    SFCPause := NOT ReiniciaEstado AND PausaEstado,
    SFCReset := ReiniciaEstado,
    // ...
);
// ... y análogamente para todos los demás FBs SFC</code></pre>
							</details>
						</li>
					</ul>
					<ul id="203dc82f-49f8-8039-817b-cea9d26f0a54" class="toggle">
						<li>
							<details open="">
								<summary>Crear un bloque funcional para la <strong>Estación</strong></summary>
								<ul id="203dc82f-49f8-8021-ba03-d6b4fa56322e" class="bulleted-list">
									<li style="list-style-type:disc">Nombre: <code>FB_Estacion</code></li>
								</ul>
								<ul id="203dc82f-49f8-8082-9543-e84159d4e730" class="bulleted-list">
									<li style="list-style-type:disc">Lenguaje: <code>ST</code></li>
								</ul>
								<ul id="203dc82f-49f8-8015-8fa4-df6ed3ab6fbb" class="bulleted-list">
									<li style="list-style-type:disc">Variables: <ul
											id="203dc82f-49f8-8073-b9fd-ceb7d2cc7428" class="bulleted-list">
											<li style="list-style-type:circle">Declarar las variables de la tabla de E/S
												en las imágenes de E y S (<code>AT %I*</code> y <code>AT %Q*</code>).
												<mark class="highlight-red_background"><strong>Recuerda
													</strong></mark><mark class="highlight-red_background">que este FB
													es el que tiene el control del </mark><em><mark
														class="highlight-red_background">hardware</mark></em><mark
													class="highlight-red_background">.</mark></li>
										</ul>
										<ul id="203dc82f-49f8-8062-bdaf-c5a3fd501382" class="bulleted-list">
											<li style="list-style-type:circle">Declarar una variable para el
												<strong>Coordinador </strong>y otra para cada uno de los FBs de
												<strong>Tareas </strong>(<code>CargarBase</code>, etc.).</li>
										</ul>
									</li>
								</ul>
								<ul id="203dc82f-49f8-807f-911b-e78c3b8f2632" class="bulleted-list">
									<li style="list-style-type:disc">Implementación:<ul
											id="203dc82f-49f8-80c0-9b49-e10e772b2e04" class="bulleted-list">
											<li style="list-style-type:circle">Determinar si estamos trabajando en modo
												manual o automático, usando la variable asociada al selector de modo.
												<script
													src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"

													integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
													crossorigin="anonymous" referrerPolicy="no-referrer"></script>
												<link rel="stylesheet"
													href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
													integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
													crossorigin="anonymous" referrerPolicy="no-referrer" />
												<pre id="203dc82f-49f8-80fa-8ef9-e0474a49d2a9" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">IF NOT SelectorManual THEN
	// Codigo automatico
END_IF</code></pre>
											</li>
										</ul>
										<ul id="203dc82f-49f8-80bc-823a-d8baf7732fec" class="toggle">
											<li>
												<details open="">
													<summary>En modo automático</summary>
													<ul id="203dc82f-49f8-8035-b03b-caef6d0a75d1" class="bulleted-list">
														<li style="list-style-type:disc">Instanciar el
															<code>FB_Coordinador_SFC</code>, pasándole como entrada las
															señales <code>Done</code> de las tareas (<mark
																class="highlight-purple">morado</mark>) y las variables
															declaradas en <code>FB_Estacion</code> que vayan a
															utilizarse en el coordinador (<mark
																class="highlight-orange">naranja</mark>). Presta
															especial atención a las condiciones que manejan su señal de
															<code>Execute</code>.
															<script
																src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
																integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
																crossorigin="anonymous"
																referrerPolicy="no-referrer"></script>
															<link rel="stylesheet"
																href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
																integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
																crossorigin="anonymous" referrerPolicy="no-referrer" />
															<pre id="203dc82f-49f8-80b2-b217-dace151af36f"
																class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Coordinador(
        UnidadesPendientes := UnidadesPendientes,
        UnidadesRealizadas := UnidadesRealizadas,
        SFCPause := NOT ReiniciaEstado AND PausaEstado,
        SFCReset := ReiniciaEstado,
        Ack := TRUE,
        Execute := CondicionInicial AND 
	        CondicionMarcha AND 
	        PulsadorMarcha,
        Resume := PulsadorMarcha,
        StepByStep := CicloaCiclo,
        PaleSituado := SituarPale.Done,
        BaseCargada := CargarBase.Done,
        RodamientoPrensado := PrensarRodamiento.Done,
        BaseDescargada := DescargarBase.Done,
        PaleTransferido := TransferirPale.Done,
        CondicionInicial := CondicionInicial,
        UnidadesSolicitadas := UnidadesSolicitadas
        );</code></pre>
														</li>
													</ul>
													<ul id="203dc82f-49f8-8059-8346-f1bdf34a4205" class="bulleted-list">
														<li style="list-style-type:disc">Instanciar cada una de los FBs
															de Tareas pasándole como entrada los valores de los sensores
															necesarios para cada FB (<mark
																class="highlight-purple">morado</mark>) y otras
															variables declaradas en <code>FB_Estacion</code> que vayan a
															utilizarse en el FB (<mark
																class="highlight-orange">naranja</mark>).
															<script
																src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
																integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
																crossorigin="anonymous"
																referrerPolicy="no-referrer"></script>
															<link rel="stylesheet"
																href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
																integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
																crossorigin="anonymous" referrerPolicy="no-referrer" />
															<pre id="203dc82f-49f8-806b-ae41-d8fb44201861"
																class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">SituarPale(
        SFCPause := NOT ReiniciaEstado AND PausaEstado,
        SFCReset := ReiniciaEstado,
        Ack := NOT Coordinador.SituaPale,
        Execute := Coordinador.SituaPale,
        TpoPaleEntrada := TpoPaleEntrada,
        PresenciaPale := PresenciaPale,
        CodigoPaleBit0 := CodigoPaleBit0,
        CodigoPaleBit1 := CodigoPaleBit1,
        CodigoPaleBit2 := CodigoPaleBit2
        );</code></pre>
														</li>
													</ul>
													<ul id="203dc82f-49f8-80e7-81a8-d5e058b5b8a0" class="bulleted-list">
														<li style="list-style-type:disc">Capturar las señales de salida
															de los FBs de Tareas y asignarlos a las señales de salida
															que controlan el <em>hardware</em>. </li>
													</ul>
													<ul id="203dc82f-49f8-8098-ac1a-e240c7718059" class="bulleted-list">
														<li style="list-style-type:disc">Capturar también el valor de
															<code>CodigoPale</code>.
															<script
																src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
																integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
																crossorigin="anonymous"
																referrerPolicy="no-referrer"></script>
															<link rel="stylesheet"
																href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
																integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
																crossorigin="anonymous" referrerPolicy="no-referrer" />
															<pre id="203dc82f-49f8-8058-8783-f5ebcf2267e3"
																class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">// Acciones
LamparaAlarma := Coordinador.LamparaAlarma;
LamparaMarcha := Coordinador.LamparaMarcha;

CintaActiva := NOT PausaEstado 
	AND (SituarPale.CintaActiva OR TransferirPale.CintaActiva);
        
RetenedorBaja:= TransferirPale.RetenedorBaja;

ManipuladorAvanza := CargarBase.ManipuladorAdelante 
        OR DescargarBase.ManipuladorAdelante;

// ...
        
CodigoPale := SituarPale.CodigoPale;</code></pre>
														</li>
													</ul>
												</details>
											</li>
										</ul>
										<ul id="203dc82f-49f8-8072-8dbf-f7b9d909220d" class="toggle">
											<li>
												<details open="">
													<summary>En modo manual</summary>
													<ul id="203dc82f-49f8-8031-8cb8-d9dfcf899cba" class="bulleted-list">
														<li style="list-style-type:disc">Establecer el valor de
															<code>CodigoPale</code> directamente desde los sensores (ya
															que, al no ejecutarse el código de <code>SituarPale</code>,
															éste no puede devolver su valor).
															<script
																src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
																integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
																crossorigin="anonymous"
																referrerPolicy="no-referrer"></script>
															<link rel="stylesheet"
																href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
																integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
																crossorigin="anonymous" referrerPolicy="no-referrer" />
															<pre id="203dc82f-49f8-80cb-8205-ff00383be608"
																class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">CodigoPale.0 := CodigoPaleBit0;
CodigoPale.1 := CodigoPaleBit1;
CodigoPale.2 := CodigoPaleBit2;</code></pre>
														</li>
													</ul>
												</details>
											</li>
										</ul>
										<ul id="203dc82f-49f8-805b-b280-de6f5dbef246" class="toggle">
											<li>
												<details open="">
													<summary>En cualquier modo </summary>
													<ul id="203dc82f-49f8-80c4-b3dd-dea5dce604f9" class="bulleted-list">
														<li style="list-style-type:disc">Establecer las condiciones
															iniciales y de marcha.
															<script
																src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
																integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
																crossorigin="anonymous" referrerPolicy="no-referrer"></script>
															<link rel="stylesheet"
																href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
																integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
																crossorigin="anonymous" referrerPolicy="no-referrer" />
															<pre id="203dc82f-49f8-8085-b69f-fc54e463d80e"
																class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">// Parametros de salida
CondicionInicial := EstacionConectada 
    AND ManipuladorMedio 
    AND IntroductorDetras 
    AND ExtractorDetras 
    AND PrensadorArriba;
    
CondicionMarcha := (UnidadesSolicitadas &gt; 0);</code></pre>
														</li>
													</ul>
												</details>
											</li>
										</ul>
									</li>
								</ul>
							</details>
						</li>
					</ul>
					<ul id="203dc82f-49f8-80a4-af48-cee26b9d0101" class="toggle">
						<li>
							<details open="">
								<summary>Realizar una visualización para el programa</summary>
								<ul id="203dc82f-49f8-80eb-8b95-d39ce6225a5e"
									class="block-color-red_background bulleted-list">
									<li style="list-style-type:disc">Esta visualización es idéntica a la del nivel
										monolítico (solo cambia la etiqueta de arriba a la derecha).</li>
								</ul>
								<figure id="203dc82f-49f8-8075-aa5a-e08bb3570cac" class="image"
									style="text-align:center"><a href="images/n3/image 7.png"><img style="width:480px"
											src="images/n3/image 7.png" /></a>
									<figcaption>Visualización del nivel estructurado</figcaption>
								</figure>
								<ul id="203dc82f-49f8-8023-9e3a-e8455092710e" class="bulleted-list">
									<li style="list-style-type:disc">Todas las señales deben estar representadas</li>
								</ul>
								<ul id="203dc82f-49f8-80c5-b2da-ccc16069ffb3" class="bulleted-list">
									<li style="list-style-type:disc">Decidir si los botones deben ser <em>Tap </em>o
										<em>Toggle</em></li>
								</ul>
								<ul id="203dc82f-49f8-8042-aafd-cd78e734e529" class="bulleted-list">
									<li style="list-style-type:disc">Incluir el visor del número de ciclos total y los
										que quedan por completar</li>
								</ul>
								<ul id="203dc82f-49f8-807d-a900-ddeac9968728" class="bulleted-list">
									<li style="list-style-type:disc">Los tiempos utilizados en los bloques funcionales
										deben ser configurables en la visualización</li>
								</ul>
								<ul id="203dc82f-49f8-8045-a123-c22cce1e7b05" class="bulleted-list">
									<li style="list-style-type:disc">Añadir cualquier otra información que sea
										interesante mostrar</li>
								</ul>
								<ul id="203dc82f-49f8-80d3-b011-d40aac6ca6f3" class="bulleted-list">
									<li style="list-style-type:disc">Añadir botones para <strong>RESET</strong> y
										<strong>PAUSE</strong> (abajo)</li>
								</ul>
								<ul id="203dc82f-49f8-8064-a882-eb2e33c53e28" class="bulleted-list">
									<li style="list-style-type:disc">Añadir indicadores de cumplimiento de las
										condiciones iniciales y de marcha (abajo)</li>
								</ul>
							</details>
						</li>
					</ul>
					<ul id="203dc82f-49f8-8032-bedf-f5b8534d9b07" class="bulleted-list">
						<li style="list-style-type:disc">Compilar el proyecto y comprobar que no tiene errores</li>
					</ul>
					<ul id="203dc82f-49f8-801c-9c75-d699b1684b30" class="block-color-yellow_background toggle">
						<li>
							<details open="">
								<summary>Si se tiene acceso a la estación</summary>
								<ul id="203dc82f-49f8-8007-aae9-e75bfb62ccab" class="bulleted-list">
									<li style="list-style-type:disc">Buscar la estación en la red y conectarse</li>
								</ul>
								<ul id="203dc82f-49f8-80ae-a03c-cf0eaed7ad60" class="bulleted-list">
									<li style="list-style-type:disc">Buscar los terminales de E/S con TwinCAT3</li>
								</ul>
								<ul id="203dc82f-49f8-8001-8483-d38ceea9c428" class="bulleted-list">
									<li style="list-style-type:disc">Renombrar los terminales de E/S según la tabla</li>
								</ul>
								<ul id="203dc82f-49f8-808d-a171-f99238b1d04f" class="bulleted-list">
									<li style="list-style-type:disc">Enlazar las variables del programa con los
										terminales de E/S</li>
								</ul>
								<ul id="203dc82f-49f8-8022-8d77-d3cf21ac2fc1" class="bulleted-list">
									<li style="list-style-type:disc">Activar la configuración en la estación</li>
								</ul>
								<ul id="203dc82f-49f8-80d5-b14a-f80cd6792c44" class="bulleted-list">
									<li style="list-style-type:disc">Descargar el programa en la estación (<em>Log
											in</em>)</li>
								</ul>
								<ul id="203dc82f-49f8-8065-8be6-d283391e73c5" class="bulleted-list">
									<li style="list-style-type:disc">Ejecutar el programa (<em>Start</em>)</li>
								</ul>
								<ul id="203dc82f-49f8-8047-8981-eae5bacc4331" class="bulleted-list">
									<li style="list-style-type:disc">Probar el funcionamiento</li>
								</ul>
							</details>
						</li>
					</ul>
					<ul id="203dc82f-49f8-80fb-89fd-c8f0769530bc" class="block-color-gray_background toggle">
						<li>
							<details open="">
								<summary>Si no se tiene acceso a la estación</summary>
								<ul id="203dc82f-49f8-80d2-a5cf-c9aa6a08b509" class="bulleted-list">
									<li style="list-style-type:disc">Activar la configuración en el equipo local</li>
								</ul>
								<ul id="203dc82f-49f8-80aa-9a96-f780e6f5cf8e" class="bulleted-list">
									<li style="list-style-type:disc">Descargar el programa en el equipo local (<em>Log
											in</em>)</li>
								</ul>
								<ul id="203dc82f-49f8-8040-b81a-dac8da2d4f6a" class="bulleted-list">
									<li style="list-style-type:disc">Ejecutar el programa (<em>Start</em>)</li>
								</ul>
								<ul id="203dc82f-49f8-8098-8228-da535510496a" class="bulleted-list">
									<li style="list-style-type:disc">Comprobar que la visualización cambia los valores
										de las variables correctas</li>
								</ul>
								<ul id="203dc82f-49f8-8044-976f-c70a99af8d98" class="bulleted-list">
									<li style="list-style-type:disc"><strong>Usar la visualización para hacer
											evolucionar el programa</strong></li>
								</ul>
							</details>
						</li>
					</ul>
				</div>
			</details>
		</div>
	</article><span class="sans" style="font-size:14px;padding-top:2em"></span>
</body>

</html>